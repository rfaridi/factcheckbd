---
title: UN vote on Jerusalem (Part 3)
author: Rushad Faridi
date: 2018-03-09
categories: []
tags: []
---



# Housekeeping stuff


libraries to use

```{r libs  }
library(dplyr)
library(ggplot2)
library(janitor)
library(pander)
```

Let's source the functions


```{r fns  }
source("../RFILES/misc_fun.R")
source("../RFILES/fig_serial_ref.R")
source("../RFILES/tab_serial_ref.R")
```


now let's load the data

```{r ld  }
# load("./RDATA/un_vote_mg.RData")
# the above does not work, so let' load the following
load("../RDATA/all_un_cont.RData")
```

Try to find the coordinates of countries

```{r dd,eval=FALSE  }
wmap.countries <- readOGR(dsn="../oriol_mirosa_demo/RAWDATA", layer="ne_110m_admin_0_countries")
crd.df  <- coordinates(wmap.countries)
```

# World map

Now let's do the plotting

```{r plmg  }
all.un.cont %>% 
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),alpha=0.8,color="black") +
    coord_equal()+
    theme_void()
```

okay in the above, i have a very basic map drawn. now let me incorporate some improved features from 
`https://bhaskarvk.github.io/user2017.geodataviz/notebooks/02-Static-Maps.nb.html`

now here i go

```{r imp  }
all.un.cont %>% 
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
		 alpha=0.8,
		 color='black') +
    scale_fill_manual(values=c(N="red",Y="green",A="brown",abs="grey"))+
    coord_equal()+
    theme_void()
    #viridis::scale_fill_viridis(option="magma")

```

# Regional analysis

## Region details

Let's first checkout how many regions are out there and correpsonding results

```{r reg  }
all.un.cont.dis <- all.un.cont %>% 
    distinct(country,.keep_all=TRUE)
all.un.cont.dis %>% 
    tabyl_clean("continent","Continent") %>% 
    pander()
```

Now let's find the know percentage 


```{r no}
all.un.cont.dis %>% 
    tabyl(continent,status) %>% 
    adorn_totals() %>% 
    adorn_percentages() %>% 
    adorn_pct_formatting() %>% 
    adorn_ns() %>% 
    pander()

```

In the above we find that America and ocenia has the lowest percentage of saying yes.
Now let's go into the details of each continent.

## Africa
Let's check which are the countries said other than yes

```{r af1  }
all.un.cont.dis %>% 
    filter(continent=="Africa",
	   !status=="Y") %>% 
    select(country,status) 
    
```

We find that only Togo said no


let's check out the distribution in the countries

```{r imp2  }
all.un.cont %>% 
filter(continent=="Africa") %>%  
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
		 alpha=0.8,
		 color='black') +
    scale_fill_manual(values=c(N="red",Y="green",A="brown",abs="grey"))+
    coord_equal()+
    theme_void()
    #viridis::scale_fill_viridis(option="magma")

```

## Americas

Let's check which are the countries said other than yes

```{r af3  }
all.un.cont.dis %>% 
    filter(continent=="Americas",
	   !status=="Y") %>% 
    select(country,status) 
```


let's check out the distribution in the map 

```{r imp3  }
all.un.cont %>% 
filter(continent=="Americas") %>%  
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
		 alpha=0.8,
		 color='black') +
    scale_fill_manual(values=c(N="red",Y="green",A="brown",abs="grey"))+
    coord_equal()+
    theme_void()
    #viridis::scale_fill_viridis(option="magma")

```




## Asia

Let's check which are the countries said other than yes

```{r af  }
all.un.cont.dis %>% 
    filter(continent=="Asia",
	   !status=="Y") %>% 
    select(country,status) 
```


let's check out the distribution in the map 

```{r imp4  }
all.un.cont %>% 
filter(continent=="Asia") %>%  
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
		 alpha=0.8,
		 color='black') +
    scale_fill_manual(values=c(N="red",Y="green",A="brown",abs="grey"))+
    coord_equal()+
    theme_void()
    #viridis::scale_fill_viridis(option="magma")

```



## Europe

Let's check which are the countries said other than yes

```{r af2  }
all.un.cont.dis %>% 
    filter(continent=="Europe",
	   !status=="Y") %>% 
    select(country,status) 
```



Now let's do the same for Europe

```{r imp5  }
all.un.cont %>% 
filter(continent=="Europe") %>%  
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
		 alpha=0.8,
		 color='black') +
    scale_fill_manual(values=c(N="red",Y="green",A="brown",abs="grey"))+
    coord_equal()+
    theme_void()
    #viridis::scale_fill_viridis(option="magma")
```


## Oceania 

It seems here only 2 said yes but Australia abstained, others are not that significant

```{r af6  }
all.un.cont.dis %>% 
    filter(continent=="Oceania") %>% 
    select(country,status) 
```


let's check out the distribution in the map 

```{r imp6  }
all.un.cont %>% 
filter(continent=="Oceania") %>%  
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
		 alpha=0.8,
		 color='black') +
    scale_fill_manual(values=c(N="red",Y="green",A="brown",abs="grey"))+
    coord_equal()+
    theme_void()
    #viridis::scale_fill_viridis(option="magma")

```


