---
title: UN vote on Jerusalem (Part 3)
author: Rushad Faridi
date: 2018-03-09
categories: []
tags: []
---



<div id="housekeeping-stuff" class="section level1">
<h1>Housekeeping stuff</h1>
<p>libraries to use</p>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(ggplot2)
library(janitor)
library(pander)</code></pre>
<p>Let’s source the functions</p>
<pre class="r"><code>source(&quot;../RFILES/misc_fun.R&quot;)
source(&quot;../RFILES/fig_serial_ref.R&quot;)
source(&quot;../RFILES/tab_serial_ref.R&quot;)</code></pre>
<p>now let’s load the data</p>
<pre class="r"><code># load(&quot;./RDATA/un_vote_mg.RData&quot;)
# the above does not work, so let&#39; load the following
load(&quot;../RDATA/all_un_cont.RData&quot;)</code></pre>
<p>Try to find the coordinates of countries</p>
<pre class="r"><code>wmap.countries &lt;- readOGR(dsn=&quot;../oriol_mirosa_demo/RAWDATA&quot;, layer=&quot;ne_110m_admin_0_countries&quot;)
crd.df  &lt;- coordinates(wmap.countries)</code></pre>
</div>
<div id="world-map" class="section level1">
<h1>World map</h1>
<p>Now let’s do the plotting</p>
<pre class="r"><code>all.un.cont %&gt;% 
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),alpha=0.8,color=&quot;black&quot;) +
    coord_equal()+
    theme_void()</code></pre>
<p><img src="/post/jerusalem_data_explore_files/figure-html/plmg-1.png" width="672" /></p>
<p>okay in the above, i have a very basic map drawn. now let me incorporate some improved features from <code>https://bhaskarvk.github.io/user2017.geodataviz/notebooks/02-Static-Maps.nb.html</code></p>
<p>now here i go</p>
<pre class="r"><code>all.un.cont %&gt;% 
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
         alpha=0.8,
         color=&#39;black&#39;) +
    scale_fill_manual(values=c(N=&quot;red&quot;,Y=&quot;green&quot;,A=&quot;brown&quot;,abs=&quot;grey&quot;))+
    coord_equal()+
    theme_void()</code></pre>
<p><img src="/post/jerusalem_data_explore_files/figure-html/imp-1.png" width="672" /></p>
<pre class="r"><code>    #viridis::scale_fill_viridis(option=&quot;magma&quot;)</code></pre>
</div>
<div id="regional-analysis" class="section level1">
<h1>Regional analysis</h1>
<div id="region-details" class="section level2">
<h2>Region details</h2>
<p>Let’s first checkout how many regions are out there and correpsonding results</p>
<pre class="r"><code>all.un.cont.dis &lt;- all.un.cont %&gt;% 
    distinct(country,.keep_all=TRUE)
all.un.cont.dis %&gt;% 
    tabyl_clean(&quot;continent&quot;,&quot;Continent&quot;) %&gt;% 
    pander()</code></pre>
<table style="width:35%;">
<colgroup>
<col width="16%" />
<col width="5%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Continent</th>
<th align="center">N</th>
<th align="center">Percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Africa</td>
<td align="center">54</td>
<td align="center">28</td>
</tr>
<tr class="even">
<td align="center">Americas</td>
<td align="center">35</td>
<td align="center">18.1</td>
</tr>
<tr class="odd">
<td align="center">Asia</td>
<td align="center">47</td>
<td align="center">24.4</td>
</tr>
<tr class="even">
<td align="center">Europe</td>
<td align="center">43</td>
<td align="center">22.3</td>
</tr>
<tr class="odd">
<td align="center">Oceania</td>
<td align="center">14</td>
<td align="center">7.3</td>
</tr>
<tr class="even">
<td align="center">Total</td>
<td align="center">193</td>
<td align="center">100</td>
</tr>
</tbody>
</table>
<p>Now let’s find the know percentage</p>
<pre class="r"><code>all.un.cont.dis %&gt;% 
    tabyl(continent,status) %&gt;% 
    adorn_totals() %&gt;% 
    adorn_percentages() %&gt;% 
    adorn_pct_formatting() %&gt;% 
    adorn_ns() %&gt;% 
    pander()</code></pre>
<table style="width:79%;">
<colgroup>
<col width="16%" />
<col width="15%" />
<col width="13%" />
<col width="16%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">continent</th>
<th align="center">A</th>
<th align="center">N</th>
<th align="center">Y</th>
<th align="center">abs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Africa</td>
<td align="center">14.8% (8)</td>
<td align="center">1.9% (1)</td>
<td align="center">68.5% (37)</td>
<td align="center">14.8% (8)</td>
</tr>
<tr class="even">
<td align="center">Americas</td>
<td align="center">34.3% (12)</td>
<td align="center">8.6% (3)</td>
<td align="center">48.6% (17)</td>
<td align="center">8.6% (3)</td>
</tr>
<tr class="odd">
<td align="center">Asia</td>
<td align="center">4.3% (2)</td>
<td align="center">2.1% (1)</td>
<td align="center">83.0% (39)</td>
<td align="center">10.6% (5)</td>
</tr>
<tr class="even">
<td align="center">Europe</td>
<td align="center">16.3% (7)</td>
<td align="center">0.0% (0)</td>
<td align="center">76.7% (33)</td>
<td align="center">7.0% (3)</td>
</tr>
<tr class="odd">
<td align="center">Oceania</td>
<td align="center">42.9% (6)</td>
<td align="center">28.6% (4)</td>
<td align="center">14.3% (2)</td>
<td align="center">14.3% (2)</td>
</tr>
<tr class="even">
<td align="center">Total</td>
<td align="center">18.1% (35)</td>
<td align="center">4.7% (9)</td>
<td align="center">66.3% (128)</td>
<td align="center">10.9% (21)</td>
</tr>
</tbody>
</table>
<p>In the above we find that America and ocenia has the lowest percentage of saying yes. Now let’s go into the details of each continent.</p>
</div>
<div id="africa" class="section level2">
<h2>Africa</h2>
<p>Let’s check which are the countries said other than yes</p>
<pre class="r"><code>all.un.cont.dis %&gt;% 
    filter(continent==&quot;Africa&quot;,
       !status==&quot;Y&quot;) %&gt;% 
    select(country,status) </code></pre>
<pre><code>##                             country status
## 1                             BENIN      A
## 2                          CAMEROON      A
## 3                 EQUATORIAL GUINEA      A
## 4                           LESOTHO      A
## 5                            MALAWI      A
## 6                            RWANDA      A
## 7                       SOUTH SUDAN      A
## 8                              TOGO      N
## 9                            UGANDA      A
## 10         CENTRAL AFRICAN REPUBLIC    abs
## 11 DEMOCRATIC REPUBLIC OF THE CONGO    abs
## 12                   GUINEA-BISSAU     abs
## 13                           KENYA     abs
## 14            SAO TOME AND PRINCIPE    abs
## 15                     SIERRA LEONE    abs
## 16                       SWAZILAND     abs
## 17                          ZAMBIA     abs</code></pre>
<p>We find that only Togo said no</p>
<p>let’s check out the distribution in the countries</p>
<pre class="r"><code>all.un.cont %&gt;% 
filter(continent==&quot;Africa&quot;) %&gt;%  
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
         alpha=0.8,
         color=&#39;black&#39;) +
    scale_fill_manual(values=c(N=&quot;red&quot;,Y=&quot;green&quot;,A=&quot;brown&quot;,abs=&quot;grey&quot;))+
    coord_equal()+
    theme_void()</code></pre>
<p><img src="/post/jerusalem_data_explore_files/figure-html/imp2-1.png" width="672" /></p>
<pre class="r"><code>    #viridis::scale_fill_viridis(option=&quot;magma&quot;)</code></pre>
</div>
<div id="americas" class="section level2">
<h2>Americas</h2>
<p>Let’s check which are the countries said other than yes</p>
<pre class="r"><code>all.un.cont.dis %&gt;% 
    filter(continent==&quot;Americas&quot;,
       !status==&quot;Y&quot;) %&gt;% 
    select(country,status) </code></pre>
<pre><code>##                  country status
## 1    ANTIGUA AND BARBUDA      A
## 2              ARGENTINA      A
## 3                BAHAMAS      A
## 4                 CANADA      A
## 5               COLOMBIA      A
## 6     DOMINICAN REPUBLIC      A
## 7              GUATEMALA      N
## 8                  HAITI      A
## 9               HONDURAS      N
## 10               JAMAICA      A
## 11                MEXICO      A
## 12                PANAMA      A
## 13              PARAGUAY      A
## 14   TRINIDAD AND TOBAGO      A
## 15         UNITED STATES      N
## 16           EL SALVADOR    abs
## 17 SAINT KITTS AND NEVIS    abs
## 18           SAINT LUCIA    abs</code></pre>
<p>let’s check out the distribution in the map</p>
<pre class="r"><code>all.un.cont %&gt;% 
filter(continent==&quot;Americas&quot;) %&gt;%  
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
         alpha=0.8,
         color=&#39;black&#39;) +
    scale_fill_manual(values=c(N=&quot;red&quot;,Y=&quot;green&quot;,A=&quot;brown&quot;,abs=&quot;grey&quot;))+
    coord_equal()+
    theme_void()</code></pre>
<p><img src="/post/jerusalem_data_explore_files/figure-html/imp3-1.png" width="672" /></p>
<pre class="r"><code>    #viridis::scale_fill_viridis(option=&quot;magma&quot;)</code></pre>
</div>
<div id="asia" class="section level2">
<h2>Asia</h2>
<p>Let’s check which are the countries said other than yes</p>
<pre class="r"><code>all.un.cont.dis %&gt;% 
    filter(continent==&quot;Asia&quot;,
       !status==&quot;Y&quot;) %&gt;% 
    select(country,status) </code></pre>
<pre><code>##         country status
## 1        BHUTAN      A
## 2        ISRAEL      N
## 3   PHILIPPINES      A
## 4      GEORGIA     abs
## 5     MONGOLIA     abs
## 6      MYANMAR     abs
## 7  TIMOR-LESTE     abs
## 8 TURKMENISTAN     abs</code></pre>
<p>let’s check out the distribution in the map</p>
<pre class="r"><code>all.un.cont %&gt;% 
filter(continent==&quot;Asia&quot;) %&gt;%  
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
         alpha=0.8,
         color=&#39;black&#39;) +
    scale_fill_manual(values=c(N=&quot;red&quot;,Y=&quot;green&quot;,A=&quot;brown&quot;,abs=&quot;grey&quot;))+
    coord_equal()+
    theme_void()</code></pre>
<p><img src="/post/jerusalem_data_explore_files/figure-html/imp4-1.png" width="672" /></p>
<pre class="r"><code>    #viridis::scale_fill_viridis(option=&quot;magma&quot;)</code></pre>
</div>
<div id="europe" class="section level2">
<h2>Europe</h2>
<p>Let’s check which are the countries said other than yes</p>
<pre class="r"><code>all.un.cont.dis %&gt;% 
    filter(continent==&quot;Europe&quot;,
       !status==&quot;Y&quot;) %&gt;% 
    select(country,status) </code></pre>
<pre><code>##                   country status
## 1  BOSNIA AND HERZEGOVINA      A
## 2                 CROATIA      A
## 3          CZECH REPUBLIC      A
## 4                 HUNGARY      A
## 5                  LATVIA      A
## 6                  POLAND      A
## 7                 ROMANIA      A
## 8     REPUBLIC OF MOLDOVA    abs
## 9              SAN MARINO    abs
## 10               UKRAINE     abs</code></pre>
<p>Now let’s do the same for Europe</p>
<pre class="r"><code>all.un.cont %&gt;% 
filter(continent==&quot;Europe&quot;) %&gt;%  
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
         alpha=0.8,
         color=&#39;black&#39;) +
    scale_fill_manual(values=c(N=&quot;red&quot;,Y=&quot;green&quot;,A=&quot;brown&quot;,abs=&quot;grey&quot;))+
    coord_equal()+
    theme_void()</code></pre>
<p><img src="/post/jerusalem_data_explore_files/figure-html/imp5-1.png" width="672" /></p>
<pre class="r"><code>    #viridis::scale_fill_viridis(option=&quot;magma&quot;)</code></pre>
</div>
<div id="oceania" class="section level2">
<h2>Oceania</h2>
<p>It seems here only 2 said yes but Australia abstained, others are not that significant</p>
<pre class="r"><code>all.un.cont.dis %&gt;% 
    filter(continent==&quot;Oceania&quot;) %&gt;% 
    select(country,status) </code></pre>
<pre><code>##                             country status
## 1                         AUSTRALIA      A
## 2                              FIJI      A
## 3                          KIRIBATI      A
## 4                  MARSHALL ISLANDS      N
## 5  MICRONESIA (FEDERATED STATES OF)      N
## 6                             NAURU      N
## 7                       NEW ZEALAND      Y
## 8                             PALAU      N
## 9                  PAPUA NEW GUINEA      Y
## 10                  SOLOMON ISLANDS      A
## 11                           TUVALU      A
## 12                          VANUATU      A
## 13                           SAMOA     abs
## 14                           TONGA     abs</code></pre>
<p>let’s check out the distribution in the map</p>
<pre class="r"><code>all.un.cont %&gt;% 
filter(continent==&quot;Oceania&quot;) %&gt;%  
ggplot() +
    geom_polygon(aes(long,lat,group=group,fill=status),
         alpha=0.8,
         color=&#39;black&#39;) +
    scale_fill_manual(values=c(N=&quot;red&quot;,Y=&quot;green&quot;,A=&quot;brown&quot;,abs=&quot;grey&quot;))+
    coord_equal()+
    theme_void()</code></pre>
<p><img src="/post/jerusalem_data_explore_files/figure-html/imp6-1.png" width="672" /></p>
<pre class="r"><code>    #viridis::scale_fill_viridis(option=&quot;magma&quot;)</code></pre>
</div>
</div>
