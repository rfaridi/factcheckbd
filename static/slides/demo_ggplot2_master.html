<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>ggplot2 demo</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs-2.1/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/hygge.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/ninjutsu.css" rel="stylesheet" />
    <link rel="stylesheet" href="myprez.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# ggplot2 demo

---





Let's load the library



```r
library(tidyverse)
library(flipbookr)
library(ggforce)
library(scales)
```






class: split-45
count: false
 

 
.column[.content[

```r
*mtcars
```
]]
.column[.content[

```
                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
```
]]
---
class: split-45
count: false
 

 
.column[.content[

```r
mtcars %&gt;%  
*   mutate(gear=as.factor(gear))
```
]]
.column[.content[

```
                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
```
]]
---
class: split-45
count: false
 

 
.column[.content[

```r
mtcars %&gt;%  
    mutate(gear=as.factor(gear)) %&gt;%  
*   count(gear)
```
]]
.column[.content[

```
  gear  n
1    3 15
2    4 12
3    5  5
```
]]
---
class: split-45
count: false
 

 
.column[.content[

```r
mtcars %&gt;%  
    mutate(gear=as.factor(gear)) %&gt;%  
    count(gear) %&gt;%  
*   mutate(total=sum(n),
*   end_angle = 2*pi*cumsum(n)/total,
*   start_angle = lag(end_angle, default = 0),
*   mid_angle = 0.5*(start_angle + end_angle),
*   hjust = ifelse(mid_angle&gt;pi, 1, 0),
*   vjust = ifelse(mid_angle&lt;pi/2 |
*	   mid_angle&gt;3*pi/2, 0, 1)) -&gt; mtpie
```
]]
.column[.content[

]]
---
class: split-45
count: false
 

 
.column[.content[

```r
mtcars %&gt;%  
    mutate(gear=as.factor(gear)) %&gt;%  
    count(gear) %&gt;%  
    mutate(total=sum(n),  
    end_angle = 2*pi*cumsum(n)/total,  
    start_angle = lag(end_angle, default = 0),  
    mid_angle = 0.5*(start_angle + end_angle),  
    hjust = ifelse(mid_angle&gt;pi, 1, 0),  
    vjust = ifelse(mid_angle&lt;pi/2 |  
		   mid_angle&gt;3*pi/2, 0, 1)) -&gt; mtpie  

*mtpie
```
]]
.column[.content[

```
  gear  n total end_angle start_angle mid_angle hjust vjust
1    3 15    32  2.945243    0.000000  1.472622     0     0
2    4 12    32  5.301438    2.945243  4.123340     1     1
3    5  5    32  6.283185    5.301438  5.792311     1     0
```
]]

---



class: split-50
count: false
 

 
.column[.content[

```r
*rpie = 1
```
]]
.column[.content[

]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
*rlabel = 0.6 * rpie
```
]]
.column[.content[

]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

*mtpie
```
]]
.column[.content[

```
  gear  n total end_angle start_angle mid_angle hjust vjust
1    3 15    32  2.945243    0.000000  1.472622     0     0
2    4 12    32  5.301438    2.945243  4.123340     1     1
3    5  5    32  6.283185    5.301438  5.792311     1     0
```
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
*ggplot()
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_4_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
ggplot() +  
* geom_arc_bar(
*aes(x0 = 0,
*    y0=0,
*    r0= 0,
*    r = rpie,
*           start = start_angle,
*    end = end_angle))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_5_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
ggplot() +  
  geom_arc_bar(  
	aes(x0 = 0,  
	    y0=0,  
	    r0= 0,  
	    r = rpie,  
            start = start_angle,  
	    end = end_angle)) +  
*        aes(fill=gear)
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_6_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
ggplot() +  
  geom_arc_bar(  
	aes(x0 = 0,  
	    y0=0,  
	    r0= 0,  
	    r = rpie,  
            start = start_angle,  
	    end = end_angle)) +  
         aes(fill=gear)+  
*  geom_text(aes(x = rlabel*sin(mid_angle),
*	 y = rlabel*cos(mid_angle),
*	 label =percent(n/sum(n),accuracy=1)),
*     hjust = 0.5,
*     vjust = 0.5,
*     size=6,
*     color="#f7be16" )
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_7_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
ggplot() +  
  geom_arc_bar(  
	aes(x0 = 0,  
	    y0=0,  
	    r0= 0,  
	    r = rpie,  
            start = start_angle,  
	    end = end_angle)) +  
         aes(fill=gear)+  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(n/sum(n),accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=6,  
	     color="#f7be16" ) +  
*  coord_fixed()
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_8_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
ggplot() +  
  geom_arc_bar(  
	aes(x0 = 0,  
	    y0=0,  
	    r0= 0,  
	    r = rpie,  
            start = start_angle,  
	    end = end_angle)) +  
         aes(fill=gear)+  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(n/sum(n),accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=6,  
	     color="#f7be16" ) +  
   coord_fixed() +  
*  scale_fill_manual(values=c("#293462", "#00818a", "#918969"))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_9_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
ggplot() +  
  geom_arc_bar(  
	aes(x0 = 0,  
	    y0=0,  
	    r0= 0,  
	    r = rpie,  
            start = start_angle,  
	    end = end_angle)) +  
         aes(fill=gear)+  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(n/sum(n),accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=6,  
	     color="#f7be16" ) +  
   coord_fixed() +  
   scale_fill_manual(values=c("#293462", "#00818a", "#918969")) +  
*      theme_void()
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_10_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
ggplot() +  
  geom_arc_bar(  
	aes(x0 = 0,  
	    y0=0,  
	    r0= 0,  
	    r = rpie,  
            start = start_angle,  
	    end = end_angle)) +  
         aes(fill=gear)+  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(n/sum(n),accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=6,  
	     color="#f7be16" ) +  
   coord_fixed() +  
   scale_fill_manual(values=c("#293462", "#00818a", "#918969")) +  
       theme_void() +  
*    theme(legend.position="bottom")
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_11_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
ggplot() +  
  geom_arc_bar(  
	aes(x0 = 0,  
	    y0=0,  
	    r0= 0,  
	    r = rpie,  
            start = start_angle,  
	    end = end_angle)) +  
         aes(fill=gear)+  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(n/sum(n),accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=6,  
	     color="#f7be16" ) +  
   coord_fixed() +  
   scale_fill_manual(values=c("#293462", "#00818a", "#918969")) +  
       theme_void() +  
     theme(legend.position="bottom")+  
*    theme(legend.title=element_blank())
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_12_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
ggplot() +  
  geom_arc_bar(  
	aes(x0 = 0,  
	    y0=0,  
	    r0= 0,  
	    r = rpie,  
            start = start_angle,  
	    end = end_angle)) +  
         aes(fill=gear)+  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(n/sum(n),accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=6,  
	     color="#f7be16" ) +  
   coord_fixed() +  
   scale_fill_manual(values=c("#293462", "#00818a", "#918969")) +  
       theme_void() +  
     theme(legend.position="bottom")+  
     theme(legend.title=element_blank()) +  
*    theme(legend.text=element_text(size=16))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_13_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
ggplot() +  
  geom_arc_bar(  
	aes(x0 = 0,  
	    y0=0,  
	    r0= 0,  
	    r = rpie,  
            start = start_angle,  
	    end = end_angle)) +  
         aes(fill=gear)+  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(n/sum(n),accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=6,  
	     color="#f7be16" ) +  
   coord_fixed() +  
   scale_fill_manual(values=c("#293462", "#00818a", "#918969")) +  
       theme_void() +  
     theme(legend.position="bottom")+  
     theme(legend.title=element_blank()) +  
     theme(legend.text=element_text(size=16)) +  
*    theme(plot.background=element_rect(fill="#FAFAFA",
*                                 linetype="blank"))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_14_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
rpie = 1  
rlabel = 0.6 * rpie  

mtpie %&gt;%  
ggplot() +  
  geom_arc_bar(  
	aes(x0 = 0,  
	    y0=0,  
	    r0= 0,  
	    r = rpie,  
            start = start_angle,  
	    end = end_angle)) +  
         aes(fill=gear)+  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(n/sum(n),accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=6,  
	     color="#f7be16" ) +  
   coord_fixed() +  
   scale_fill_manual(values=c("#293462", "#00818a", "#918969")) +  
       theme_void() +  
     theme(legend.position="bottom")+  
     theme(legend.title=element_blank()) +  
     theme(legend.text=element_text(size=16)) +  
     theme(plot.background=element_rect(fill="#FAFAFA",  
                                  linetype="blank"))  
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie2_auto_15_output-1.png)&lt;!-- --&gt;
]]

---

The whole thing was packaged in the following function 


```r
theme_void_custom  &lt;- theme_void() + 
                    theme(strip.background=element_rect(fill="grey"),
			  legend.position="right", 
			  legend.title=element_blank(), 
			  legend.text=element_text(size=16),
			  plot.background=element_rect(fill="#FAFAFA", 
						 linetype="blank"))
pie3_manual_fill &lt;- c("#293462", "#00818a", "#918969")
pie_chart_oneway &lt;- function(df, group_var,manual_fill=pie3_manual_fill){
dat_pies &lt;-  df %&gt;%  
	           count({{group_var}}) %&gt;% 
		   mutate(total=sum(n),
		          end_angle = 2*pi*cumsum(n)/total,      
			    start_angle = lag(end_angle, default = 0),   
			    mid_angle = 0.5*(start_angle + end_angle),
                            hjust = ifelse(mid_angle&gt;pi, 1, 0),
                            vjust = ifelse(mid_angle&lt;pi/2 | mid_angle&gt;3*pi/2, 0, 1))
rpie = 1 
rlabel = 0.6 * rpie 
ggplot(dat_pies) + 
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,
                   start = start_angle, end = end_angle, fill = {{group_var}})) +
   geom_text(aes(x = rlabel*sin(mid_angle), 
		 y = rlabel*cos(mid_angle), 
		 label =percent(n/sum(n),accuracy=1)), 
	     hjust = 0.5, 
	     vjust = 0.5,
	     size=6,
	     color="#f7be16" ) +
   coord_fixed()+
   scale_fill_manual(values=manual_fill)+
   theme_void_custom 
 
}
```
---

The function put to use


```r
mtcars %&gt;% 
    mutate(gear=as.factor(gear)) %&gt;% 
pie_chart_oneway(gear)
```

![](demo_ggplot2_master_files/figure-html/unnamed-chunk-5-1.png)&lt;!-- --&gt;





Let's first introduce the data 


```r
gss_cat
```

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```

---


```r
theme_pie_twoway  &lt;- theme_void() + 
                    theme(strip.text.x=element_text(size=16,color="#f7be16"),
			  strip.background=element_rect(fill="#293462"),
			  legend.title=element_blank(), 
			  legend.key.width=unit(2,"cm"),
			  legend.text=element_text(size=14),
			  plot.background=element_rect(fill="#FAFAFA", 
						 linetype="blank"))

pie_chart_twoway &lt;- function(df, group_var1,group_var2) {
df %&gt;% 
    count({{group_var2}})  %&gt;% 
    nrow() -&gt; ncolor
fill_values &lt;- RColorBrewer::brewer.pal(ncolor, "Set3") #%&gt;% rev()
dat_pies &lt;-  df %&gt;%  
	           count({{group_var1}},{{group_var2}}) %&gt;% 
		   group_by({{group_var1}}) %&gt;% 
		   mutate(total=sum(n),
			  prop=round(n/sum(n),2),
		           end_angle = 2*pi*cumsum(n)/total,      
			    start_angle = lag(end_angle, default = 0),   
			    mid_angle = 0.5*(start_angle + end_angle),
                            hjust = ifelse(mid_angle&gt;pi, 1, 0),
                            vjust = ifelse(mid_angle&lt;pi/2 | mid_angle&gt;3*pi/2, 0, 1))
rpie = 1 
rlabel = 0.6 * rpie 
                    
ggplot(dat_pies) + 
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,
                   start = start_angle, end = end_angle, fill = {{group_var2}})) +
   geom_text(aes(x = rlabel*sin(mid_angle), 
		 y = rlabel*cos(mid_angle), 
		 label =percent(prop,accuracy=1)), 
	     hjust = 0.5, 
	     vjust = 0.5,
	     size=3,
	     color="Black" ) +
   coord_fixed()+
   scale_fill_manual(values=fill_values)+
		   facet_wrap(ensym(group_var1),ncol=1) + 
		   theme_pie_twoway 
}
```

---

The function is now put to use 

.pull-left[

```r
gss_cat %&gt;% 
    mutate(race=fct_relevel(race,c("White","Black","Other")),
	   marital=fct_relevel(marital,c("Married","Widowed",
					 "Divorced","Separated",
					 "Never married","No answer"))
	     ) %&gt;% 
pie_chart_twoway(race, marital)
```
]

.pull-right[

![](demo_ggplot2_master_files/figure-html/pie-chart-twoway-output-1.png)&lt;!-- --&gt;


]


---



class: split-40
count: false
 

 
.column[.content[

```r
*gss &lt;- gss_cat
```
]]
.column[.content[

]]
---
class: split-40
count: false
 

 
.column[.content[

```r
gss &lt;- gss_cat %&gt;%  
*   mutate(race=fct_relevel(race,c("White","Black","Other")),
*   marital=fct_relevel(marital,c("Married","Widowed",
*				 "Divorced","Separated",
*				 "Never married","No answer")))
```
]]
.column[.content[

]]
---
class: split-40
count: false
 

 
.column[.content[

```r
gss &lt;- gss_cat %&gt;%  
    mutate(race=fct_relevel(race,c("White","Black","Other")),  
	   marital=fct_relevel(marital,c("Married","Widowed",  
					 "Divorced","Separated",  
					 "Never married","No answer")))  
*gss
```
]]
.column[.content[

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```r
gss &lt;- gss_cat %&gt;%  
    mutate(race=fct_relevel(race,c("White","Black","Other")),  
	   marital=fct_relevel(marital,c("Married","Widowed",  
					 "Divorced","Separated",  
					 "Never married","No answer")))  
gss  
*levels(gss$race)
```
]]
.column[.content[

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```

```
[1] "White"          "Black"          "Other"          "Not applicable"
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```r
gss &lt;- gss_cat %&gt;%  
    mutate(race=fct_relevel(race,c("White","Black","Other")),  
	   marital=fct_relevel(marital,c("Married","Widowed",  
					 "Divorced","Separated",  
					 "Never married","No answer")))  
gss  
levels(gss$race)  
*levels(gss$marital)
```
]]
.column[.content[

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```

```
[1] "White"          "Black"          "Other"          "Not applicable"
```

```
[1] "Married"       "Widowed"       "Divorced"      "Separated"    
[5] "Never married" "No answer"    
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```r
gss &lt;- gss_cat %&gt;%  
    mutate(race=fct_relevel(race,c("White","Black","Other")),  
	   marital=fct_relevel(marital,c("Married","Widowed",  
					 "Divorced","Separated",  
					 "Never married","No answer")))  
gss  
levels(gss$race)  
levels(gss$marital)  

*gss
```
]]
.column[.content[

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```

```
[1] "White"          "Black"          "Other"          "Not applicable"
```

```
[1] "Married"       "Widowed"       "Divorced"      "Separated"    
[5] "Never married" "No answer"    
```

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```r
gss &lt;- gss_cat %&gt;%  
    mutate(race=fct_relevel(race,c("White","Black","Other")),  
	   marital=fct_relevel(marital,c("Married","Widowed",  
					 "Divorced","Separated",  
					 "Never married","No answer")))  
gss  
levels(gss$race)  
levels(gss$marital)  

gss %&gt;%  
*   count(race,marital)
```
]]
.column[.content[

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```

```
[1] "White"          "Black"          "Other"          "Not applicable"
```

```
[1] "Married"       "Widowed"       "Divorced"      "Separated"    
[5] "Never married" "No answer"    
```

```
# A tibble: 18 x 3
   race  marital           n
   &lt;fct&gt; &lt;fct&gt;         &lt;int&gt;
 1 White Married        8316
 2 White Widowed        1475
 3 White Divorced       2676
 4 White Separated       437
 5 White Never married  3478
 6 White No answer        13
 7 Black Married         869
 8 Black Widowed         262
 9 Black Divorced        495
10 Black Separated       196
11 Black Never married  1305
12 Black No answer         2
13 Other Married         932
14 Other Widowed          70
15 Other Divorced        212
16 Other Separated       110
17 Other Never married   633
18 Other No answer         2
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```r
gss &lt;- gss_cat %&gt;%  
    mutate(race=fct_relevel(race,c("White","Black","Other")),  
	   marital=fct_relevel(marital,c("Married","Widowed",  
					 "Divorced","Separated",  
					 "Never married","No answer")))  
gss  
levels(gss$race)  
levels(gss$marital)  

gss %&gt;%  
    count(race,marital) %&gt;%  
*   group_by(race)
```
]]
.column[.content[

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```

```
[1] "White"          "Black"          "Other"          "Not applicable"
```

```
[1] "Married"       "Widowed"       "Divorced"      "Separated"    
[5] "Never married" "No answer"    
```

```
# A tibble: 18 x 3
# Groups:   race [3]
   race  marital           n
   &lt;fct&gt; &lt;fct&gt;         &lt;int&gt;
 1 White Married        8316
 2 White Widowed        1475
 3 White Divorced       2676
 4 White Separated       437
 5 White Never married  3478
 6 White No answer        13
 7 Black Married         869
 8 Black Widowed         262
 9 Black Divorced        495
10 Black Separated       196
11 Black Never married  1305
12 Black No answer         2
13 Other Married         932
14 Other Widowed          70
15 Other Divorced        212
16 Other Separated       110
17 Other Never married   633
18 Other No answer         2
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```r
gss &lt;- gss_cat %&gt;%  
    mutate(race=fct_relevel(race,c("White","Black","Other")),  
	   marital=fct_relevel(marital,c("Married","Widowed",  
					 "Divorced","Separated",  
					 "Never married","No answer")))  
gss  
levels(gss$race)  
levels(gss$marital)  

gss %&gt;%  
    count(race,marital) %&gt;%  
    group_by(race) %&gt;%  
*   mutate(total=sum(n),
*   prop=round(n/sum(n),2),
*   end_angle = 2*pi*cumsum(n)/total,
*   start_angle = lag(end_angle, default = 0),
*   mid_angle = 0.5*(start_angle + end_angle),
*   hjust = ifelse(mid_angle&gt;pi, 1, 0),
*   vjust = ifelse(mid_angle&lt;pi/2 | mid_angle&gt;3*pi/2, 0, 1)) -&gt; gss_pies
```
]]
.column[.content[

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```

```
[1] "White"          "Black"          "Other"          "Not applicable"
```

```
[1] "Married"       "Widowed"       "Divorced"      "Separated"    
[5] "Never married" "No answer"    
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```r
gss &lt;- gss_cat %&gt;%  
    mutate(race=fct_relevel(race,c("White","Black","Other")),  
	   marital=fct_relevel(marital,c("Married","Widowed",  
					 "Divorced","Separated",  
					 "Never married","No answer")))  
gss  
levels(gss$race)  
levels(gss$marital)  

gss %&gt;%  
    count(race,marital) %&gt;%  
    group_by(race) %&gt;%  
    mutate(total=sum(n),  
    prop=round(n/sum(n),2),  
    end_angle = 2*pi*cumsum(n)/total,  
    start_angle = lag(end_angle, default = 0),  
    mid_angle = 0.5*(start_angle + end_angle),  
    hjust = ifelse(mid_angle&gt;pi, 1, 0),  
    vjust = ifelse(mid_angle&lt;pi/2 | mid_angle&gt;3*pi/2, 0, 1)) -&gt; gss_pies  
*gss_pies
```
]]
.column[.content[

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```

```
[1] "White"          "Black"          "Other"          "Not applicable"
```

```
[1] "Married"       "Widowed"       "Divorced"      "Separated"    
[5] "Never married" "No answer"    
```

```
# A tibble: 18 x 10
# Groups:   race [3]
   race  marital       n total  prop end_angle start_angle mid_angle hjust vjust
   &lt;fct&gt; &lt;fct&gt;     &lt;int&gt; &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 White Married    8316 16395  0.51      3.19        0        1.59      0     1
 2 White Widowed    1475 16395  0.09      3.75        3.19     3.47      1     1
 3 White Divorced   2676 16395  0.16      4.78        3.75     4.27      1     1
 4 White Separated   437 16395  0.03      4.95        4.78     4.86      1     0
 5 White Never ma…  3478 16395  0.21      6.28        4.95     5.61      1     0
 6 White No answer    13 16395  0         6.28        6.28     6.28      1     0
 7 Black Married     869  3129  0.28      1.74        0        0.872     0     0
 8 Black Widowed     262  3129  0.08      2.27        1.74     2.01      0     1
 9 Black Divorced    495  3129  0.16      3.27        2.27     2.77      0     1
10 Black Separated   196  3129  0.06      3.66        3.27     3.46      1     1
11 Black Never ma…  1305  3129  0.42      6.28        3.66     4.97      1     0
12 Black No answer     2  3129  0         6.28        6.28     6.28      1     0
13 Other Married     932  1959  0.48      2.99        0        1.49      0     0
14 Other Widowed      70  1959  0.04      3.21        2.99     3.10      0     1
15 Other Divorced    212  1959  0.11      3.89        3.21     3.55      1     1
16 Other Separated   110  1959  0.06      4.25        3.89     4.07      1     1
17 Other Never ma…   633  1959  0.32      6.28        4.25     5.26      1     0
18 Other No answer     2  1959  0         6.28        6.28     6.28      1     0
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```r
gss &lt;- gss_cat %&gt;%  
    mutate(race=fct_relevel(race,c("White","Black","Other")),  
	   marital=fct_relevel(marital,c("Married","Widowed",  
					 "Divorced","Separated",  
					 "Never married","No answer")))  
gss  
levels(gss$race)  
levels(gss$marital)  

gss %&gt;%  
    count(race,marital) %&gt;%  
    group_by(race) %&gt;%  
    mutate(total=sum(n),  
    prop=round(n/sum(n),2),  
    end_angle = 2*pi*cumsum(n)/total,  
    start_angle = lag(end_angle, default = 0),  
    mid_angle = 0.5*(start_angle + end_angle),  
    hjust = ifelse(mid_angle&gt;pi, 1, 0),  
    vjust = ifelse(mid_angle&lt;pi/2 | mid_angle&gt;3*pi/2, 0, 1)) -&gt; gss_pies  
gss_pies  
```
]]
.column[.content[

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```

```
[1] "White"          "Black"          "Other"          "Not applicable"
```

```
[1] "Married"       "Widowed"       "Divorced"      "Separated"    
[5] "Never married" "No answer"    
```

```
# A tibble: 18 x 10
# Groups:   race [3]
   race  marital       n total  prop end_angle start_angle mid_angle hjust vjust
   &lt;fct&gt; &lt;fct&gt;     &lt;int&gt; &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 White Married    8316 16395  0.51      3.19        0        1.59      0     1
 2 White Widowed    1475 16395  0.09      3.75        3.19     3.47      1     1
 3 White Divorced   2676 16395  0.16      4.78        3.75     4.27      1     1
 4 White Separated   437 16395  0.03      4.95        4.78     4.86      1     0
 5 White Never ma…  3478 16395  0.21      6.28        4.95     5.61      1     0
 6 White No answer    13 16395  0         6.28        6.28     6.28      1     0
 7 Black Married     869  3129  0.28      1.74        0        0.872     0     0
 8 Black Widowed     262  3129  0.08      2.27        1.74     2.01      0     1
 9 Black Divorced    495  3129  0.16      3.27        2.27     2.77      0     1
10 Black Separated   196  3129  0.06      3.66        3.27     3.46      1     1
11 Black Never ma…  1305  3129  0.42      6.28        3.66     4.97      1     0
12 Black No answer     2  3129  0         6.28        6.28     6.28      1     0
13 Other Married     932  1959  0.48      2.99        0        1.49      0     0
14 Other Widowed      70  1959  0.04      3.21        2.99     3.10      0     1
15 Other Divorced    212  1959  0.11      3.89        3.21     3.55      1     1
16 Other Separated   110  1959  0.06      4.25        3.89     4.07      1     1
17 Other Never ma…   633  1959  0.32      6.28        4.25     5.26      1     0
18 Other No answer     2  1959  0         6.28        6.28     6.28      1     0
```
]]

---



class: split-50
count: false
 

 
.column[.content[

```r
*gss_cat
```
]]
.column[.content[

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
*count(marital)
```
]]
.column[.content[

```
# A tibble: 6 x 2
  marital           n
* &lt;fct&gt;         &lt;int&gt;
1 No answer        17
2 Never married  5416
3 Separated       743
4 Divorced       3383
5 Widowed        1807
6 Married       10117
```
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
*       nrow()
```
]]
.column[.content[

```
[1] 6
```
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
*RColorBrewer::brewer.pal( "Set3") -&gt; my_palette
```
]]
.column[.content[

]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

*rpie = 1
```
]]
.column[.content[

]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
*rlabel = 0.6 * rpie
```
]]
.column[.content[

]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
*gss_pies
```
]]
.column[.content[

```
# A tibble: 18 x 10
# Groups:   race [3]
   race  marital       n total  prop end_angle start_angle mid_angle hjust vjust
   &lt;fct&gt; &lt;fct&gt;     &lt;int&gt; &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 White Married    8316 16395  0.51      3.19        0        1.59      0     1
 2 White Widowed    1475 16395  0.09      3.75        3.19     3.47      1     1
 3 White Divorced   2676 16395  0.16      4.78        3.75     4.27      1     1
 4 White Separated   437 16395  0.03      4.95        4.78     4.86      1     0
 5 White Never ma…  3478 16395  0.21      6.28        4.95     5.61      1     0
 6 White No answer    13 16395  0         6.28        6.28     6.28      1     0
 7 Black Married     869  3129  0.28      1.74        0        0.872     0     0
 8 Black Widowed     262  3129  0.08      2.27        1.74     2.01      0     1
 9 Black Divorced    495  3129  0.16      3.27        2.27     2.77      0     1
10 Black Separated   196  3129  0.06      3.66        3.27     3.46      1     1
11 Black Never ma…  1305  3129  0.42      6.28        3.66     4.97      1     0
12 Black No answer     2  3129  0         6.28        6.28     6.28      1     0
13 Other Married     932  1959  0.48      2.99        0        1.49      0     0
14 Other Widowed      70  1959  0.04      3.21        2.99     3.10      0     1
15 Other Divorced    212  1959  0.11      3.89        3.21     3.55      1     1
16 Other Separated   110  1959  0.06      4.25        3.89     4.07      1     1
17 Other Never ma…   633  1959  0.32      6.28        4.25     5.26      1     0
18 Other No answer     2  1959  0         6.28        6.28     6.28      1     0
```
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
*ggplot()
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_8_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
* geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,
*                  start = start_angle, end = end_angle, fill = marital ))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_9_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
*  geom_text(aes(x = rlabel*sin(mid_angle),
*	 y = rlabel*cos(mid_angle),
*	 label =percent(prop,accuracy=1)),
*     hjust = 0.5,
*     vjust = 0.5,
*     size=3,
*     color="Black" )
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_10_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(prop,accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=3,  
	     color="Black" ) +  
*  coord_fixed()
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_11_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(prop,accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=3,  
	     color="Black" ) +  
   coord_fixed()+  
*  scale_fill_manual(values=my_palette)
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_12_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(prop,accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=3,  
	     color="Black" ) +  
   coord_fixed()+  
   scale_fill_manual(values=my_palette)+  
*	   facet_wrap(~race,ncol=1)
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_13_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(prop,accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=3,  
	     color="Black" ) +  
   coord_fixed()+  
   scale_fill_manual(values=my_palette)+  
		   facet_wrap(~race,ncol=1) +  
*   theme_void()
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_14_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(prop,accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=3,  
	     color="Black" ) +  
   coord_fixed()+  
   scale_fill_manual(values=my_palette)+  
		   facet_wrap(~race,ncol=1) +  
    theme_void() +  
*   theme(strip.text.x=element_text(size=16,color="#f7be16"))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_15_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(prop,accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=3,  
	     color="Black" ) +  
   coord_fixed()+  
   scale_fill_manual(values=my_palette)+  
		   facet_wrap(~race,ncol=1) +  
    theme_void() +  
    theme(strip.text.x=element_text(size=16,color="#f7be16"))+  
*   theme(strip.background=element_rect(fill="#293462"))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_16_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(prop,accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=3,  
	     color="Black" ) +  
   coord_fixed()+  
   scale_fill_manual(values=my_palette)+  
		   facet_wrap(~race,ncol=1) +  
    theme_void() +  
    theme(strip.text.x=element_text(size=16,color="#f7be16"))+  
    theme(strip.background=element_rect(fill="#293462"))+  
*   theme(legend.title=element_blank())
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_17_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(prop,accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=3,  
	     color="Black" ) +  
   coord_fixed()+  
   scale_fill_manual(values=my_palette)+  
		   facet_wrap(~race,ncol=1) +  
    theme_void() +  
    theme(strip.text.x=element_text(size=16,color="#f7be16"))+  
    theme(strip.background=element_rect(fill="#293462"))+  
    theme(legend.title=element_blank()) +  
*   theme(legend.key.width=unit(2,"cm"))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_18_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(prop,accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=3,  
	     color="Black" ) +  
   coord_fixed()+  
   scale_fill_manual(values=my_palette)+  
		   facet_wrap(~race,ncol=1) +  
    theme_void() +  
    theme(strip.text.x=element_text(size=16,color="#f7be16"))+  
    theme(strip.background=element_rect(fill="#293462"))+  
    theme(legend.title=element_blank()) +  
    theme(legend.key.width=unit(2,"cm"))+  
*   theme(legend.text=element_text(size=14))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_19_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(prop,accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=3,  
	     color="Black" ) +  
   coord_fixed()+  
   scale_fill_manual(values=my_palette)+  
		   facet_wrap(~race,ncol=1) +  
    theme_void() +  
    theme(strip.text.x=element_text(size=16,color="#f7be16"))+  
    theme(strip.background=element_rect(fill="#293462"))+  
    theme(legend.title=element_blank()) +  
    theme(legend.key.width=unit(2,"cm"))+  
    theme(legend.text=element_text(size=14))+  
*   theme(plot.background=element_rect(fill="#FAFAFA",
*			      linetype="blank"))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_20_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	count(marital)  %&gt;%  
        nrow() %&gt;%  
	RColorBrewer::brewer.pal( "Set3") -&gt; my_palette  

rpie = 1  
rlabel = 0.6 * rpie  
gss_pies %&gt;%  
 ggplot() +  
  geom_arc_bar(aes(x0 = 0, y0 = 0, r0 = 0, r = rpie,  
                   start = start_angle, end = end_angle, fill = marital )) +  
   geom_text(aes(x = rlabel*sin(mid_angle),  
		 y = rlabel*cos(mid_angle),  
		 label =percent(prop,accuracy=1)),  
	     hjust = 0.5,  
	     vjust = 0.5,  
	     size=3,  
	     color="Black" ) +  
   coord_fixed()+  
   scale_fill_manual(values=my_palette)+  
		   facet_wrap(~race,ncol=1) +  
    theme_void() +  
    theme(strip.text.x=element_text(size=16,color="#f7be16"))+  
    theme(strip.background=element_rect(fill="#293462"))+  
    theme(legend.title=element_blank()) +  
    theme(legend.key.width=unit(2,"cm"))+  
    theme(legend.text=element_text(size=14))+  
    theme(plot.background=element_rect(fill="#FAFAFA",  
				      linetype="blank"))  
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/pie-twoway-flip_auto_21_output-1.png)&lt;!-- --&gt;
]]

---


```r
theme_basic &lt;- theme_minimal() + 
                theme(
		      plot.title=element_text(color="#00818a", 
					      family="Oswald",
					      size=20),
		      panel.grid=element_blank(), 
		      axis.text=element_blank(),
		      axis.title=element_blank(),
		      plot.background=element_rect(fill="#FAFAFA", 
						   linetype="blank")) 


theme_bar_vert_stacked  &lt;- theme_basic + 
                          theme(legend.position="bottom", 
				axis.text.x=element_text(margin=margin(t=-20)), 
				legend.title=element_blank(), 
				legend.key.width=unit(2,"cm"))

vert_oneway &lt;- function(data,cat,title=NULL) {
	 data %&gt;% 
	     count({{cat}}) %&gt;% 
         ggplot(aes(x={{cat}}, y=n) ) +
	   geom_col(fill="#ec9b3b") +
	   labs(y="",title=title) +
	   geom_text(aes(y=n/2,
			 label=comma(n)), 
			 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"
	                 ) + theme_bar_vert_stacked
}

gss_cat %&gt;% 
    vert_oneway(marital)
```

![](demo_ggplot2_master_files/figure-html/unnamed-chunk-8-1.png)&lt;!-- --&gt;





.pull-left[


```r
theme_basic &lt;- theme_minimal() + 
                theme(
		      plot.title=element_text(color="#00818a", 
					      family="Oswald",
					      size=20),
		      panel.grid=element_blank(), 
		      axis.text=element_blank(),
		      axis.title=element_blank(),
		      plot.background=element_rect(fill="#FAFAFA", 
						   linetype="blank")) 


theme_bar_vert_stacked  &lt;- theme_basic + 
                          theme(legend.position="bottom", 
				axis.text.x=element_text(margin=margin(t=-20)), 
				legend.title=element_blank(), 
				legend.key.width=unit(2,"cm"))

vert_oneway &lt;- function(data,cat,title=NULL) {
	 data %&gt;% 
	     count({{cat}}) %&gt;% 
         ggplot(aes(x={{cat}}, y=n) ) +
	   geom_col(fill="#ec9b3b") +
	   labs(y="",title=title) +
	   geom_text(aes(y=n/2,
			 label=comma(n)), 
			 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"
	                 ) + theme_bar_vert_stacked
}
```

]

.pull-right[

![](demo_ggplot2_master_files/figure-html/vert-out-1.png)&lt;!-- --&gt;

]

---


class: split-50
count: false
 

 
.column[.content[

```r
*gss_cat
```
]]
.column[.content[

```
# A tibble: 21,483 x 9
    year marital     age race  rincome    partyid     relig     denom    tvhours
   &lt;int&gt; &lt;fct&gt;     &lt;int&gt; &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;
 1  2000 Never ma…    26 White $8000 to … Ind,near r… Protesta… Souther…      12
 2  2000 Divorced     48 White $8000 to … Not str re… Protesta… Baptist…      NA
 3  2000 Widowed      67 White Not appli… Independent Protesta… No deno…       2
 4  2000 Never ma…    39 White Not appli… Ind,near r… Orthodox… Not app…       4
 5  2000 Divorced     25 White Not appli… Not str de… None      Not app…       1
 6  2000 Married      25 White $20000 - … Strong dem… Protesta… Souther…      NA
 7  2000 Never ma…    36 White $25000 or… Not str re… Christian Not app…       3
 8  2000 Divorced     44 White $7000 to … Ind,near d… Protesta… Luthera…      NA
 9  2000 Married      44 White $25000 or… Not str de… Protesta… Other          0
10  2000 Married      47 White $25000 or… Strong rep… Protesta… Souther…       3
# … with 21,473 more rows
```
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
*     count(marital)
```
]]
.column[.content[

```
# A tibble: 6 x 2
  marital           n
* &lt;fct&gt;         &lt;int&gt;
1 No answer        17
2 Never married  5416
3 Separated       743
4 Divorced       3383
5 Widowed        1807
6 Married       10117
```
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
*        ggplot()
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_3_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
*    aes(x=marital)
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_4_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
*    aes(y=n)
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_5_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
*   geom_col()
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_6_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
*   geom_col(fill="#ec9b3b")
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_7_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
	   geom_col(fill="#ec9b3b") +  
*   labs(title="Marital distribution")
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_8_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
	   geom_col(fill="#ec9b3b") +  
	   labs(title="Marital distribution") +  
*   geom_text(aes(y=n/2,
*		 label=comma(n)),
*		 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"
*                 )
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_9_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
	   geom_col(fill="#ec9b3b") +  
	   labs(title="Marital distribution") +  
	   geom_text(aes(y=n/2,  
			 label=comma(n)),  
			 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"  
	                 ) +  
*            theme_minimal()
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_10_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
	   geom_col(fill="#ec9b3b") +  
	   labs(title="Marital distribution") +  
	   geom_text(aes(y=n/2,  
			 label=comma(n)),  
			 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"  
	                 ) +  
             theme_minimal() +  
*               theme(plot.title=element_text(color="#00818a",
*				      family="Oswald",
*				      size=20))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_11_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
	   geom_col(fill="#ec9b3b") +  
	   labs(title="Marital distribution") +  
	   geom_text(aes(y=n/2,  
			 label=comma(n)),  
			 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"  
	                 ) +  
             theme_minimal() +  
                theme(plot.title=element_text(color="#00818a",  
					      family="Oswald",  
					      size=20)) +  
*	theme(panel.grid=element_blank())
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_12_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
	   geom_col(fill="#ec9b3b") +  
	   labs(title="Marital distribution") +  
	   geom_text(aes(y=n/2,  
			 label=comma(n)),  
			 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"  
	                 ) +  
             theme_minimal() +  
                theme(plot.title=element_text(color="#00818a",  
					      family="Oswald",  
					      size=20)) +  
		theme(panel.grid=element_blank()) +  
*	theme(axis.text=element_blank())
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_13_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
	   geom_col(fill="#ec9b3b") +  
	   labs(title="Marital distribution") +  
	   geom_text(aes(y=n/2,  
			 label=comma(n)),  
			 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"  
	                 ) +  
             theme_minimal() +  
                theme(plot.title=element_text(color="#00818a",  
					      family="Oswald",  
					      size=20)) +  
		theme(panel.grid=element_blank()) +  
		theme(axis.text=element_blank()) +  
*	theme(plot.background=element_rect(fill="#FAFAFA",
*					   linetype="blank"))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_14_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
	   geom_col(fill="#ec9b3b") +  
	   labs(title="Marital distribution") +  
	   geom_text(aes(y=n/2,  
			 label=comma(n)),  
			 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"  
	                 ) +  
             theme_minimal() +  
                theme(plot.title=element_text(color="#00818a",  
					      family="Oswald",  
					      size=20)) +  
		theme(panel.grid=element_blank()) +  
		theme(axis.text=element_blank()) +  
		theme(plot.background=element_rect(fill="#FAFAFA",  
						   linetype="blank")) +  
*                         theme(legend.position="bottom")
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_15_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
	   geom_col(fill="#ec9b3b") +  
	   labs(title="Marital distribution") +  
	   geom_text(aes(y=n/2,  
			 label=comma(n)),  
			 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"  
	                 ) +  
             theme_minimal() +  
                theme(plot.title=element_text(color="#00818a",  
					      family="Oswald",  
					      size=20)) +  
		theme(panel.grid=element_blank()) +  
		theme(axis.text=element_blank()) +  
		theme(plot.background=element_rect(fill="#FAFAFA",  
						   linetype="blank")) +  
                          theme(legend.position="bottom")+  
*		  theme(axis.text.x=element_text(margin=margin(t=-20)))
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_16_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
	   geom_col(fill="#ec9b3b") +  
	   labs(title="Marital distribution") +  
	   geom_text(aes(y=n/2,  
			 label=comma(n)),  
			 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"  
	                 ) +  
             theme_minimal() +  
                theme(plot.title=element_text(color="#00818a",  
					      family="Oswald",  
					      size=20)) +  
		theme(panel.grid=element_blank()) +  
		theme(axis.text=element_blank()) +  
		theme(plot.background=element_rect(fill="#FAFAFA",  
						   linetype="blank")) +  
                          theme(legend.position="bottom")+  
			  theme(axis.text.x=element_text(margin=margin(t=-20)))+  
*		  theme(legend.title=element_blank())
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_17_output-1.png)&lt;!-- --&gt;
]]
---
class: split-50
count: false
 

 
.column[.content[

```r
gss_cat %&gt;%  
	     count(marital) %&gt;%  
         ggplot() +  
	    aes(x=marital) +  
	    aes(y=n)  +  
	   geom_col() +  
	   geom_col(fill="#ec9b3b") +  
	   labs(title="Marital distribution") +  
	   geom_text(aes(y=n/2,  
			 label=comma(n)),  
			 hjust=0,vjust=0, size=3, family='Oswald', color="#293462"  
	                 ) +  
             theme_minimal() +  
                theme(plot.title=element_text(color="#00818a",  
					      family="Oswald",  
					      size=20)) +  
		theme(panel.grid=element_blank()) +  
		theme(axis.text=element_blank()) +  
		theme(plot.background=element_rect(fill="#FAFAFA",  
						   linetype="blank")) +  
                          theme(legend.position="bottom")+  
			  theme(axis.text.x=element_text(margin=margin(t=-20)))+  
			  theme(legend.title=element_blank())  
```
]]
.column[.content[
![](demo_ggplot2_master_files/figure-html/gss-vert_auto_18_output-1.png)&lt;!-- --&gt;
]]




    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:10",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
